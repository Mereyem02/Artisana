{% extends 'base.html.twig' %}

{% block title %}Coopératives - Artisana.ma{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/cooperative_index.css') }}">
{% endblock %}

{% block body %}
<div class="container">
    <div class="page-header">
        <h1><i class="fas fa-handshake"></i> Nos Coopératives</h1>
        <p>Rencontrez les coopératives artisanales du Maroc</p>
    </div>

    {% if is_granted('ROLE_ADMIN') %}
    <div class="admin-actions">
        <a href="/cooperative/new" class="btn btn-primary">
            <i class="fas fa-plus"></i> Ajouter une coopérative
        </a>
    </div>
    {% endif %}

    {% if cooperatives is empty %}
        <div class="card empty-cooperatives">
            <i class="fas fa-users"></i>
            <h3>Aucune coopérative trouvée</h3>
            <p>Ajoutez votre première coopérative</p>
        </div>
    {% else %}
        <div class="grid">
            {% for cooperative in cooperatives %}
                <div class="card">
                    <div class="cooperative-card-header">
                        <div class="coop-logo-container">
                            {% if cooperative.logo %}
                                <img src="{{ asset(cooperative.logo) }}" alt="Logo {{ cooperative.nom }}" class="coop-logo-img">
                            {% else %}
                                <i class="fas fa-handshake"></i>
                            {% endif %}
                        </div>
                    </div>
                    
                    <h3 class="cooperative-name">{{ cooperative.nom }}</h3>
                    
                    <p class="cooperative-description">
                        {{ cooperative.description|slice(0, 100) }}{% if cooperative.description|length > 100 %}...{% endif %}
                    </p>
                    
                    <div class="cooperative-info-card">
                        <p>
                            <i class="fas fa-map-marker-alt"></i>
                            {{ cooperative.ville ?? 'Ville non renseignée' }}
                        </p>
                        <p>
                            <i class="fas fa-envelope"></i>
                            {{ cooperative.email ?? 'Email non renseigné' }}
                        </p>
                        <p>
                            <i class="fas fa-phone"></i>
                            {{ cooperative.telephone ?? 'Téléphone non renseigné' }}
                        </p>
                    </div>
                    
                    <div class="cooperative-actions">
                        <a href="/cooperative/{{ cooperative.id }}" class="btn btn-secondary">
                            <i class="fas fa-eye"></i> Voir
                        </a>
                        {% if is_granted('ROLE_ADMIN') %}
                        <a href="/cooperative/{{ cooperative.id }}/edit" class="btn btn-primary">
                            <i class="fas fa-edit"></i> Modifier
                        </a>
                        <form method="post" action="/cooperative/{{ cooperative.id }}/delete" 
                              class="js-confirm-delete inline-form" 
                              style="display:inline;"
                              data-title="Supprimer la coopérative ?"
                              data-text="Voulez-vous vraiment supprimer la coopérative '{{ cooperative.nom }}' ? Cette action est définitive."
                              data-confirm-button="Oui, supprimer">
                            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ cooperative.id) }}">
                            <button type="submit" class="btn btn-danger">
                                <i class="fas fa-trash"></i> Supprimer
                            </button>
                        </form>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="navigation text-center mt-4">
            {{ knp_pagination_render(cooperatives) }}
        </div>
    {% endif %}
</div>

{% endblock %}
